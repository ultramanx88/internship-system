# ฟีเจอร์พรีวิวเอกสารใบสมัครฝึกงาน

## ภาพรวม
ฟีเจอร์นี้ช่วยให้นักศึกษาสามารถพรีวิวเอกสารที่จะถูกสร้างจากข้อมูลที่กรอกในฟอร์มใบสมัครฝึกงาน/สหกิจศึกษา ก่อนที่จะส่งใบสมัครจริง

## ฟีเจอร์หลัก

### 1. ปุ่มพรีวิวเอกสาร
- เพิ่มปุ่ม "พรีวิวเอกสาร" ข้างๆ ปุ่ม "ส่งใบสมัคร"
- ตรวจสอบข้อมูลที่จำเป็นก่อนแสดงพรีวิว
- แสดงข้อความแจ้งเตือนหากข้อมูลไม่ครบถ้วน

### 2. หน้าต่างพรีวิวเอกสาร
- แสดงเอกสารทั้งหมดที่จะถูกสร้าง
- สลับดูเอกสารต่างๆ ได้ (หนังสือขอฝึกงาน, หนังสือส่งตัว)
- แสดงข้อมูลสรุปการสมัครด้านข้าง
- แสดงโลโก้ตราครุฑในส่วนหัวเอกสาร
- เลือกภาษาได้ (ไทย/อังกฤษ) สำหรับนักศึกษาต่างชาติ

### 3. การแมปข้อมูลจากฟอร์มไปยังเอกสาร

#### ข้อมูลที่แมปโดยตรง:
- **ชื่อ-นามสกุล**: จาก `user.name`
- **รหัสนักศึกษา**: จาก `user.studentId`
- **อีเมล**: จาก `user.email`
- **ตำแหน่งงาน**: จาก `internship.title`
- **บริษัท**: จาก `internship.company`
- **สถานที่**: จาก `internship.location`
- **วันที่เริ่ม**: จาก `formData.preferredStartDate` (แปลงเป็นรูปแบบไทย)
- **ระยะเวลา**: จาก `formData.availableDuration`
- **เหตุผลในการสมัคร**: จาก `formData.studentReason`
- **ทักษะที่คาดหวัง**: จาก `formData.expectedSkills`

#### ข้อมูลเพิ่มเติมสำหรับสหกิจศึกษา:
- **หัวข้อโครงการ**: จาก `formData.projectProposal`
- **อาจารย์ที่ปรึกษา**: แสดงข้อความ "[จะได้รับการมอบหมายภายหลัง]"
- **อาจารย์นิเทศ**: แสดงข้อความ "[จะได้รับการมอบหมายภายหลัง]"

#### ข้อมูลที่ต้องเพิ่มเติมภายหลัง:
- **คณะ**: จาก `user.faculty` (หากไม่มีแสดง "[ระบุคณะ]")
- **สาขา**: จาก `user.department` (หากไม่มีแสดง "[ระบุสาขา]")
- **ชั้นปี**: จาก `user.year` (หากไม่มีแสดง "[ระบุชั้นปี]")

## เอกสารที่สร้าง

### สำหรับฝึกงาน (Internship):
1. **01_หนังสือขอฝึกงาน** - เอกสารขออนุญาตฝึกงานจากบริษัท
2. **02_หนังสือส่งตัวฝึกงาน** - เอกสารส่งตัวนักศึกษาไปฝึกงาน

### สำหรับสหกิจศึกษา (Co-op):
1. **01_แบบฟอร์มขอสหกิจศึกษา** - แบบฟอร์มสมัครสหกิจศึกษา (ไทย/อังกฤษ)
2. **02_หนังสือขอสหกิจศึกษา** - เอกสารขออนุญาตสหกิจศึกษาจากบริษัท
3. **03_หนังสือส่งตัวสหกิจศึกษา** - เอกสารส่งตัวนักศึกษาไปสหกิจศึกษา

## การใช้งาน

1. **กรอกฟอร์มใบสมัคร** - กรอกข้อมูลที่จำเป็นทั้งหมด
2. **คลิกปุ่มพรีวิวเอกสาร** - ระบบจะตรวจสอบข้อมูลก่อน
3. **ตรวจสอบเอกสาร** - ดูเอกสารที่จะถูกสร้างและตรวจสอบความถูกต้อง
4. **ส่งใบสมัคร** - หากข้อมูลถูกต้องแล้ว คลิก "ตกลง ส่งใบสมัคร"

## ข้อดี

- **ลดข้อผิดพลาด**: นักศึกษาสามารถตรวจสอบข้อมูลก่อนส่ง
- **เพิ่มความมั่นใจ**: เห็นผลลัพธ์จริงก่อนส่งใบสมัคร
- **ประหยัดเวลา**: ไม่ต้องแก้ไขข้อมูลหลังส่งแล้ว
- **โปร่งใส**: เห็นว่าข้อมูลจากฟอร์มไปอยู่ตรงไหนในเอกสาร

## ไฟล์ที่เกี่ยวข้อง

### คอมโพเนนต์หลัก
- `src/components/student/DocumentPreview.tsx` - คอมโพเนนต์หลักสำหรับพรีวิวเอกสาร
- `src/components/student/DocumentRenderer.tsx` - คอมโพเนนต์แสดงเอกสารแบบ A4
- `src/app/(dashboard)/student/application-form/[type]/page.tsx` - ฟอร์มใบสมัครที่เพิ่มปุ่มพรีวิว

### ระบบเทมเพลต
- `src/lib/real-templates.ts` - เทมเพลตจริงจากไฟล์ PDF/DOCX
- `src/lib/html-templates.ts` - เทมเพลต HTML ที่ตรงกับเอกสารจริง
- `src/components/student/HtmlDocumentRenderer.tsx` - คอมโพเนนต์แสดง HTML template
- `scripts/read-document-templates.js` - สคริปต์อ่านไฟล์เทมเพลต
- `document-templates/analysis.json` - ผลการวิเคราะห์เทมเพลต

### ไฟล์สนับสนุน
- `src/lib/date-utils.ts` - ฟังก์ชันจัดการวันที่ภาษาไทย
- `document-templates/assets/images/garuda-logo.png` - โลโก้ตราครุฑ
- `public/assets/images/garuda-logo.png` - โลโก้สำหรับเว็บแอป

### Package ที่ติดตั้ง
- `pdf-parse` - อ่านไฟล์ PDF
- `mammoth` - อ่านไฟล์ DOCX

## รูปแบบเทมเพลตที่ใช้

ฟีเจอร์นี้ใช้รูปแบบเทมเพลตจริงจากโฟลเดอร์ `document-templates/` โดยมีตัวแปรที่สอดคล้องกับ `src/lib/document-utils.ts`:

### ตัวแปรหลักที่ใช้:
- `{{studentName}}` - ชื่อ-นามสกุลนักศึกษา
- `{{studentId}}` - รหัสนักศึกษา (เลขไทยสำหรับเอกสารไทย)
- `{{studentIdOriginal}}` - รหัสนักศึกษาเลขอารบิก
- `{{studentEmail}}` - อีเมลนักศึกษา
- `{{companyName}}` - ชื่อบริษัท
- `{{documentNumber}}` - เลขที่เอกสาร (เลขไทยสำหรับเอกสารไทย)
- `{{documentDate}}` - วันที่เอกสาร (รูปแบบไทย/อังกฤษ)
- `{{currentDate}}` - วันที่ปัจจุบัน
- `{{universityName}}` - ชื่อมหาวิทยาลัย (ไทย/อังกฤษ)
- `{{facultyName}}` - ชื่อคณะ (ไทย/อังกฤษ)
- `{{departmentName}}` - ชื่อภาควิชา (ไทย/อังกฤษ)
- `{{academicYear}}` - ปีการศึกษา (พ.ศ./ค.ศ.)
- `{{year}}` - ชั้นปี (เลขไทย/อารบิก)

### รูปแบบเอกสาร:
- **ส่วนหัว**: โลโก้ตราครุฑ + ชื่อมหาวิทยาลัย + หัวข้อเอกสาร
- **แบบฟอร์มสหกิจศึกษา**: รูปแบบฟอร์มแบ่งเป็นส่วนที่ 1, 2 พร้อมช่องกรอกข้อมูล
- **หนังสือราชการ**: เลขที่เอกสาร วันที่ เรื่อง เรียน และรายละเอียด
- **ลายเซ็น**: ส่วนลงชื่อและตำแหน่งผู้รับผิดชอบ

## การปรับปรุงล่าสุด

### ใช้เทมเพลตจริงจากไฟล์ PDF/DOCX
- **ติดตั้ง Package**: `pdf-parse` และ `mammoth` สำหรับอ่านไฟล์ PDF/DOCX
- **อ่านเทมเพลตจริง**: สคริปต์ `scripts/read-document-templates.js` อ่านไฟล์จริง
- **วิเคราะห์โครงสร้าง**: สร้างไฟล์ `document-templates/analysis.json` 
- **เทมเพลตแม่นยำ**: ใช้รูปแบบจากเอกสารจริงใน `src/lib/real-templates.ts`

### HTML Templates (ใหม่!)
- **HTML Templates**: เทมเพลต HTML ที่ตรงกับเอกสารจริง 100%
- **CSS Styling**: สไตล์ที่เหมือนเอกสารจริงทุกรายละเอียด
- **ควบคุมง่าย**: จัดการ layout ด้วย HTML/CSS แทน text parsing
- **สลับได้**: ปุ่มสลับระหว่าง HTML และ Text template

### ปรับปรุง Layout และ UX
- **DocumentRenderer**: คอมโพเนนต์แสดงเอกสารแบบใหม่ที่เหมือนต้นฉบับ
- **Zoom Controls**: ปุ่ม Zoom In/Out และ Reset (50%-200%)
- **รูปแบบเอกสารจริง**: กรอบดำ, เส้นประจุด, ไม่มีเงาหรือสีสัน
- **ขนาดพอดีหน้าจอ**: 600px width แทน A4 เต็มขนาด
- **Dialog ขนาดใหญ่**: max-w-6xl เพื่อให้เห็นปุ่ม zoom

### รูปแบบเอกสารตามต้นฉบับ
- ปรับปรุงแบบฟอร์มสหกิจศึกษาให้ตรงกับเอกสารจริง
- เพิ่มส่วนที่ 1, 2 พร้อมช่องกรอกข้อมูลตามรูปแบบมาตรฐาน
- แสดงข้อมูลที่กรอกในฟอร์มในตำแหน่งที่ถูกต้อง
- เพิ่มช่องแผนที่และข้อมูลเพิ่มเติม

### รองรับภาษาอังกฤษ
- เพิ่มปุ่มเลือกภาษา (ไทย/อังกฤษ)
- เทมเพลตภาษาอังกฤษสำหรับนักศึกษาต่างชาติ
- ชื่อมหาวิทยาลัยและหน่วยงานเป็นภาษาอังกฤษ
- รูปแบบวันที่และข้อความเป็นภาษาอังกฤษ

### การใช้เลขตามมาตรฐาน
- **เอกสารภาษาไทย**: ใช้เลขไทย (๐๑๒๓๔๕๖๗๘๙) ตามมาตรฐานเอกสารราชการ
- **เอกสารภาษาอังกฤษ**: ใช้เลขอารบิก (0123456789) ตามมาตรฐานสากล
- รหัสนักศึกษา, เลขที่เอกสาร, ปีการศึกษา, เบอร์โทรศัพท์ แปลงตามภาษา
- ปีพุทธศักราช (พ.ศ.) สำหรับเอกสารไทย, ค.ศ. สำหรับเอกสารอังกฤษ

## การพัฒนาต่อ

1. **เชื่อมต่อกับระบบสร้างเอกสารจริง** - ใช้ template engine เช่น docx-templates
2. **เพิ่มฟีเจอร์ดาวน์โหลด** - ให้สามารถดาวน์โหลดเอกสาร PDF/DOCX ได้
3. **เพิ่มการแก้ไขข้อมูลในหน้าพรีวิว** - แก้ไขข้อมูลได้โดยไม่ต้องกลับไปหน้าฟอร์ม
4. **เพิ่มเทมเพลตเอกสารอื่นๆ** - เช่น หนังสือขอบคุณ, รายงานผลการฝึกงาน
5. **เพิ่มฟิลด์เพิ่มเติม** - เช่น เบอร์โทรศัพท์, แผนที่, ข้อมูลหน่วยงาน
6. **ปรับปรุงเทมเพลตภาษาอังกฤษ** - เพิ่มเทมเพลตอื่นๆ เป็นภาษาอังกฤษ