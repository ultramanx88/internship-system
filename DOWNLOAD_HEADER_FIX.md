# ЁЯФз р╣Бр╕Бр╣Йр╣Др╕Вр╕Ыр╕▒р╕Нр╕лр╕▓р╕кр╣Ир╕зр╕Щр╕лр╕▒р╕зр╕лр╕▓р╕вр╣Др╕Ыр╣Гр╕Щр╕Бр╕▓р╕гр╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Ф PDF

## ЁЯОп р╕Ыр╕▒р╕Нр╕лр╕▓р╕Чр╕╡р╣Ир╕Юр╕Ъ
**р╕Ыр╕▒р╕Нр╕лр╕▓**: р╣Ар╕бр╕╖р╣Ир╕нр╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Фр╣Ар╕нр╕Бр╕кр╕▓р╕гр╣Ар╕Ыр╣Зр╕Щ PDF р╕кр╣Ир╕зр╕Щр╕лр╕▒р╕з (р╣Вр╕ер╣Вр╕Бр╣Йр╕бр╕лр╕▓р╕зр╕┤р╕Чр╕вр╕▓р╕ер╕▒р╕в) р╕лр╕▓р╕вр╣Др╕Ы

**р╕кр╕▓р╣Ар╕лр╕Хр╕╕**: html2canvas р╕Ир╕▒р╕Ър╣Ар╕Йр╕Юр╕▓р╕░ `.document-page` р╣Бр╕Хр╣Ир╕кр╣Ир╕зр╕Щр╕лр╕▒р╕зр╕нр╕вр╕╣р╣Ир╕Щр╕нр╕Б element р╕Щр╕╡р╣Й

## тЬЕ р╕Бр╕▓р╕гр╣Бр╕Бр╣Йр╣Др╕В

### ЁЯФН р╕зр╕┤р╕Шр╕╡р╣Бр╕Бр╣Йр╣Др╕Вр╕лр╕ер╕▒р╕Б
1. **р╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щ selector**: р╕Ир╕▓р╕Б `.document-page` р╣Ар╕Ыр╣Зр╕Щ `.w-full.max-w-4xl` (container р╕Чр╕╡р╣Ир╕гр╕зр╕бр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф)
2. **р╕гр╕нр╕гр╕╣р╕Ыр╕ар╕▓р╕Юр╣Вр╕лр╕ер╕Ф**: р╣Ар╕Юр╕┤р╣Ир╕б Promise.all р╣Ар╕Юр╕╖р╣Ир╕нр╕гр╕нр╣Вр╕ер╣Вр╕Бр╣Йр╣Вр╕лр╕ер╕Фр╣Ар╕кр╕гр╣Зр╕И
3. **р╕Ыр╕гр╕▒р╕Ъ html2canvas options**: р╣Ар╕Юр╕┤р╣Ир╕б timeout р╣Бр╕ер╕░ error handling

### ЁЯФД р╕зр╕┤р╕Шр╕╡р╕кр╕│р╕гр╕нр╕З (Fallback)
1. **р╣Бр╕вр╕Бр╕кр╣Ир╕зр╕Щр╕Ир╕▒р╕Ър╕ар╕▓р╕Ю**: р╕Ир╕▒р╕Ър╕кр╣Ир╕зр╕Щр╕лр╕▒р╕зр╣Бр╕ер╕░р╣Ар╕Щр╕╖р╣Йр╕нр╕лр╕▓р╣Бр╕вр╕Бр╕Бр╕▒р╕Щ
2. **р╕гр╕зр╕бр╣Гр╕Щ PDF**: р╕Щр╕│р╕бр╕▓р╕Ыр╕гр╕░р╕Бр╕нр╕Ър╕Бр╕▒р╕Щр╣Гр╕Щр╣Др╕Яр╕ер╣М PDF р╣Ар╕Фр╕╡р╕вр╕з
3. **Print fallback**: р╣Гр╕Кр╣Й window.print() р╕лр╕▓р╕Бр╕Чр╕╕р╕Бр╕зр╕┤р╕Шр╕╡р╕ер╣Йр╕бр╣Ар╕лр╕ер╕з

## ЁЯФз р╕Бр╕▓р╕гр╕Ыр╕гр╕▒р╕Ър╕Ыр╕гр╕╕р╕Зр╣Вр╕Др╣Йр╕Ф

### р╕лр╕▓ Element р╕Чр╕╡р╣Ир╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕З
```typescript
// р╣Ар╕Фр╕┤р╕б - р╕Ир╕▒р╕Ър╣Ар╕Йр╕Юр╕▓р╕░р╣Ар╕Щр╕╖р╣Йр╕нр╕лр╕▓
const documentElement = document.querySelector('.document-page') as HTMLElement;

// р╣Гр╕лр╕бр╣И - р╕Ир╕▒р╕Ър╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Фр╕гр╕зр╕бр╕кр╣Ир╕зр╕Щр╕лр╕▒р╕з
const documentContainer = document.querySelector('.w-full.max-w-4xl') as HTMLElement;
const documentElement = documentContainer || document.querySelector('.document-page') as HTMLElement;
```

### р╕гр╕нр╕гр╕╣р╕Ыр╕ар╕▓р╕Юр╣Вр╕лр╕ер╕Фр╣Ар╕кр╕гр╣Зр╕И
```typescript
// р╕гр╕нр╣Гр╕лр╣Йр╕гр╕╣р╕Ыр╕ар╕▓р╕Юр╣Вр╕лр╕ер╕Фр╣Ар╕кр╕гр╣Зр╕И
const images = documentElement.querySelectorAll('img');
await Promise.all(Array.from(images).map(img => {
  if (img.complete) return Promise.resolve();
  return new Promise((resolve, reject) => {
    img.onload = resolve;
    img.onerror = resolve; // р╣Др╕бр╣Ир╣Гр╕лр╣Й error р╕лр╕вр╕╕р╕Фр╕Бр╕▓р╕гр╕Чр╕│р╕Зр╕▓р╕Щ
    setTimeout(resolve, 3000); // timeout р╕лр╕ер╕▒р╕З 3 р╕зр╕┤р╕Щр╕▓р╕Чр╕╡
  });
}));
```

### р╕Ыр╕гр╕▒р╕Ъ html2canvas Options
```typescript
const canvas = await html2canvas(documentElement, {
  scale: 2, // р╕Др╕зр╕▓р╕бр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Фр╕кр╕╣р╕З
  useCORS: true,
  allowTaint: true,
  backgroundColor: '#ffffff',
  width: documentElement.scrollWidth,
  height: documentElement.scrollHeight,
  logging: false, // р╕Ыр╕┤р╕Ф logging р╣Ар╕Юр╕╖р╣Ир╕нр╕ер╕Ф noise
  imageTimeout: 5000, // timeout р╕кр╕│р╕лр╕гр╕▒р╕Ър╕гр╕╣р╕Ыр╕ар╕▓р╕Ю
  removeContainer: false
});
```

### р╕зр╕┤р╕Шр╕╡р╕кр╕│р╕гр╕нр╕З - р╣Бр╕вр╕Бр╕кр╣Ир╕зр╕Щр╕Ир╕▒р╕Ър╕ар╕▓р╕Ю
```typescript
const handleDownloadSeparate = async () => {
  const pdf = new jsPDF({
    orientation: 'portrait',
    unit: 'mm',
    format: 'a4'
  });

  // р╕Ир╕▒р╕Ър╕кр╣Ир╕зр╕Щр╕лр╕▒р╕з
  const headerElement = document.querySelector('.text-center.mb-6.bg-white.p-4') as HTMLElement;
  if (headerElement) {
    const headerCanvas = await html2canvas(headerElement, {
      scale: 2,
      useCORS: true,
      allowTaint: true,
      backgroundColor: '#ffffff'
    });
    
    const headerImgData = headerCanvas.toDataURL('image/png');
    const headerHeight = (headerCanvas.height * 210) / headerCanvas.width;
    pdf.addImage(headerImgData, 'PNG', 0, 0, 210, headerHeight);
  }

  // р╕Ир╕▒р╕Ър╣Ар╕Щр╕╖р╣Йр╕нр╕лр╕▓р╣Ар╕нр╕Бр╕кр╕▓р╕г
  const contentElement = document.querySelector('.document-page') as HTMLElement;
  if (contentElement) {
    const contentCanvas = await html2canvas(contentElement, {
      scale: 2,
      useCORS: true,
      allowTaint: true,
      backgroundColor: '#ffffff'
    });
    
    const contentImgData = contentCanvas.toDataURL('image/png');
    const startY = headerElement ? (headerElement.offsetHeight * 210) / headerElement.offsetWidth : 0;
    const contentHeight = (contentCanvas.height * 210) / contentCanvas.width;
    
    // р╣Ар╕Юр╕┤р╣Ир╕бр╕лр╕Щр╣Йр╕▓р╣Гр╕лр╕бр╣Ир╕лр╕▓р╕Бр╕Ир╕│р╣Ар╕Ыр╣Зр╕Щ
    if (startY + contentHeight > 297) {
      pdf.addPage();
      pdf.addImage(contentImgData, 'PNG', 0, 0, 210, contentHeight);
    } else {
      pdf.addImage(contentImgData, 'PNG', 0, startY, 210, contentHeight);
    }
  }

  // р╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Ф
  pdf.save(fileName);
};
```

## ЁЯОп р╕ер╕│р╕Фр╕▒р╕Ър╕Бр╕▓р╕гр╕Чр╕│р╕Зр╕▓р╕Щ (Error Handling)

### 1. р╕зр╕┤р╕Шр╕╡р╕лр╕ер╕▒р╕Б
```typescript
try {
  // р╕Ир╕▒р╕Ър╕ар╕▓р╕Юр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Фр╕гр╕зр╕бр╕кр╣Ир╕зр╕Щр╕лр╕▒р╕з
  const documentContainer = document.querySelector('.w-full.max-w-4xl');
  const canvas = await html2canvas(documentContainer, options);
  // р╕кр╕гр╣Йр╕▓р╕З PDF р╣Бр╕ер╕░р╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Ф
} catch (error) {
  // р╣Др╕Ыр╕зр╕┤р╕Шр╕╡р╕кр╕│р╕гр╕нр╕З
}
```

### 2. р╕зр╕┤р╕Шр╕╡р╕кр╕│р╕гр╕нр╕З
```typescript
try {
  // р╣Бр╕вр╕Бр╕Ир╕▒р╕Ър╕кр╣Ир╕зр╕Щр╕лр╕▒р╕зр╣Бр╕ер╕░р╣Ар╕Щр╕╖р╣Йр╕нр╕лр╕▓
  await handleDownloadSeparate();
} catch (fallbackError) {
  // р╣Др╕Ыр╕зр╕┤р╕Шр╕╡р╕кр╕╕р╕Фр╕Чр╣Йр╕▓р╕в
}
```

### 3. р╕зр╕┤р╕Шр╕╡р╕кр╕╕р╕Фр╕Чр╣Йр╕▓р╕в
```typescript
// р╣Гр╕Кр╣Й window.print()
handlePrint();
```

## ЁЯУК р╣Ар╕Ыр╕гр╕╡р╕вр╕Ър╣Ар╕Чр╕╡р╕вр╕Ър╕Бр╣Ир╕нр╕Щ/р╕лр╕ер╕▒р╕З

| р╕кр╣Ир╕зр╕Щр╕Ыр╕гр╕░р╕Бр╕нр╕Ъ | р╕Бр╣Ир╕нр╕Щр╣Бр╕Бр╣Йр╣Др╕В | р╕лр╕ер╕▒р╕Зр╣Бр╕Бр╣Йр╣Др╕В |
|-------------|-----------|-----------|
| **р╕кр╣Ир╕зр╕Щр╕лр╕▒р╕з** | тЭМ р╕лр╕▓р╕вр╣Др╕Ы | тЬЕ р╕бр╕╡р╕Др╕гр╕Ъ |
| **р╣Вр╕ер╣Вр╕Бр╣Йр╕бр╕лр╕▓р╕зр╕┤р╕Чр╕вр╕▓р╕ер╕▒р╕в** | тЭМ р╣Др╕бр╣Ир╕бр╕╡ | тЬЕ р╣Бр╕кр╕Фр╕Зр╣Ар╕Хр╣Зр╕б |
| **р╕Кр╕╖р╣Ир╕нр╕бр╕лр╕▓р╕зр╕┤р╕Чр╕вр╕▓р╕ер╕▒р╕в** | тЭМ р╣Др╕бр╣Ир╕бр╕╡ | тЬЕ р╣Бр╕кр╕Фр╕Зр╕Др╕гр╕Ъ |
| **р╣Ар╕Щр╕╖р╣Йр╕нр╕лр╕▓р╣Ар╕нр╕Бр╕кр╕▓р╕г** | тЬЕ р╕бр╕╡р╕Др╕гр╕Ъ | тЬЕ р╕бр╕╡р╕Др╕гр╕Ъ |
| **р╕Др╕╕р╕Ур╕ар╕▓р╕Ю** | тнРтнРтнР | тнРтнРтнРтнРтнР |

## ЁЯзк р╕Бр╕▓р╕гр╕Чр╕Фр╕кр╕нр╕Ъ

### тЬЕ р╕Чр╕Фр╕кр╕нр╕Ър╣Бр╕ер╣Йр╕з
- [x] р╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Ф PDF р╕гр╕зр╕бр╕кр╣Ир╕зр╕Щр╕лр╕▒р╕з
- [x] р╣Вр╕ер╣Вр╕Бр╣Йр╕бр╕лр╕▓р╕зр╕┤р╕Чр╕вр╕▓р╕ер╕▒р╕вр╣Бр╕кр╕Фр╕Зр╕Др╕гр╕Ъ
- [x] р╕Кр╕╖р╣Ир╕нр╣Ар╕нр╕Бр╕кр╕▓р╕гр╣Бр╕кр╕Фр╕Зр╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕З
- [x] Error handling р╕Чр╕│р╕Зр╕▓р╕Щр╣Др╕Фр╣Й
- [x] Fallback methods р╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╣Др╕Фр╣Й

### ЁЯФН р╕зр╕┤р╕Шр╕╡р╕Чр╕Фр╕кр╕нр╕Ъ
1. **р╣Ар╕Вр╣Йр╕▓р╕лр╕Щр╣Йр╕▓р╕Юр╕гр╕╡р╕зр╕┤р╕зр╣Ар╕нр╕Бр╕кр╕▓р╕г**
2. **р╕гр╕нр╣Вр╕ер╣Вр╕Бр╣Йр╣Вр╕лр╕ер╕Фр╣Ар╕кр╕гр╣Зр╕И** (р╕кр╕│р╕Др╕▒р╕Н!)
3. **р╕Др╕ер╕┤р╕Б "р╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Ф PDF"**
4. **р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╣Др╕Яр╕ер╣М PDF** - р╕Хр╣Йр╕нр╕Зр╕бр╕╡р╕кр╣Ир╕зр╕Щр╕лр╕▒р╕зр╕Др╕гр╕Ъ
5. **р╕Чр╕Фр╕кр╕нр╕Ър╕лр╕ер╕▓р╕вр╣Ар╕нр╕Бр╕кр╕▓р╕г** - р╣Бр╕Ър╕Ър╕Яр╕нр╕гр╣Мр╕б, р╕лр╕Щр╕▒р╕Зр╕кр╕╖р╕нр╕Вр╕н, р╕лр╕Щр╕▒р╕Зр╕кр╕╖р╕нр╕кр╣Ир╕Зр╕Хр╕▒р╕з

## тЪая╕П р╕Вр╣Йр╕нр╕Др╕зр╕гр╕гр╕░р╕зр╕▒р╕З

### р╕Бр╕▓р╕гр╣Вр╕лр╕ер╕Фр╕гр╕╣р╕Ыр╕ар╕▓р╕Ю
- **р╕гр╕нр╣Гр╕лр╣Йр╣Вр╕лр╕ер╕Фр╣Ар╕кр╕гр╣Зр╕И**: р╕Хр╣Йр╕нр╕Зр╕гр╕нр╣Вр╕ер╣Вр╕Бр╣Йр╣Вр╕лр╕ер╕Фр╕Бр╣Ир╕нр╕Щр╕Ир╕▒р╕Ър╕ар╕▓р╕Ю
- **Timeout**: р╕Хр╕▒р╣Йр╕З timeout 3-5 р╕зр╕┤р╕Щр╕▓р╕Чр╕╡р╣Ар╕Юр╕╖р╣Ир╕нр╣Др╕бр╣Ир╣Гр╕лр╣Йр╕гр╕нр╕Щр╕▓р╕Щ
- **Error handling**: р╣Др╕бр╣Ир╣Гр╕лр╣Й error р╕Вр╕нр╕Зр╕гр╕╣р╕Ыр╕ар╕▓р╕Юр╕лр╕вр╕╕р╕Фр╕Бр╕▓р╕гр╕Чр╕│р╕Зр╕▓р╕Щ

### Browser Compatibility
- **Chrome/Edge**: тЬЕ р╕Чр╕│р╕Зр╕▓р╕Щр╣Др╕Фр╣Йр╕Фр╕╡
- **Firefox**: тЬЕ р╕Чр╕│р╕Зр╕▓р╕Щр╣Др╕Фр╣Йр╕Фр╕╡
- **Safari**: тЪая╕П р╕нр╕▓р╕Ир╕бр╕╡р╕Ыр╕▒р╕Нр╕лр╕▓ CORS р╕Бр╕▒р╕Ър╣Вр╕ер╣Вр╕Бр╣Й
- **Mobile**: тЪая╕П р╕нр╕▓р╕Ир╕Кр╣Йр╕▓р╣Ар╕Щр╕╖р╣Ир╕нр╕Зр╕Ир╕▓р╕Бр╕Вр╕Щр╕▓р╕Фр╣Др╕Яр╕ер╣М

### Performance
- **р╣Др╕Яр╕ер╣Мр╣Гр╕лр╕Нр╣И**: р╕Бр╕▓р╕гр╕Ир╕▒р╕Ър╕ар╕▓р╕Юр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Фр╕Ир╕░р╣Гр╕Кр╣Йр╣Ар╕зр╕ер╕▓р╕Щр╕▓р╕Щр╕Вр╕╢р╣Йр╕Щ
- **Memory**: р╣Гр╕Кр╣Й RAM р╕бр╕▓р╕Бр╕Вр╕╢р╣Йр╕Щр╣Ар╕Щр╕╖р╣Ир╕нр╕Зр╕Ир╕▓р╕Бр╕Ир╕▒р╕Ър╕ар╕▓р╕Юр╕лр╕ер╕▓р╕вр╕кр╣Ир╕зр╕Щ
- **Loading**: р╕Хр╣Йр╕нр╕Зр╕гр╕нр╣Вр╕ер╣Вр╕Бр╣Йр╣Вр╕лр╕ер╕Фр╣Ар╕кр╕гр╣Зр╕Ир╕Бр╣Ир╕нр╕Щ

## ЁЯЪА р╕Бр╕▓р╕гр╕Ыр╕гр╕▒р╕Ър╕Ыр╕гр╕╕р╕Зр╕Хр╣Ир╕нр╣Др╕Ы

### тЬи р╕Яр╕╡р╣Ар╕Ир╕нр╕гр╣Мр╣Ар╕Юр╕┤р╣Ир╕бр╣Ар╕Хр╕┤р╕б
- [ ] Progress bar р╣Бр╕кр╕Фр╕Зр╕Др╕зр╕▓р╕бр╕Др╕╖р╕Ър╕лр╕Щр╣Йр╕▓
- [ ] Preview р╕Бр╣Ир╕нр╕Щр╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Ф
- [ ] р╣Ар╕ер╕╖р╕нр╕Бр╕Др╕╕р╕Ур╕ар╕▓р╕Юр╕Бр╕▓р╕гр╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Ф
- [ ] Batch download р╕лр╕ер╕▓р╕вр╣Ар╕нр╕Бр╕кр╕▓р╕г

### ЁЯФз р╕Бр╕▓р╕гр╕Ыр╕гр╕▒р╕Ър╕Ыр╕гр╕╕р╕З
- [ ] р╕Ыр╕гр╕▒р╕Ър╕Ыр╕гр╕╕р╕З error messages
- [ ] р╣Ар╕Юр╕┤р╣Ир╕б retry mechanism
- [ ] р╕гр╕нр╕Зр╕гр╕▒р╕Ъ mobile р╕Фр╕╡р╕Вр╕╢р╣Йр╕Щ
- [ ] р╕ер╕Фр╕Вр╕Щр╕▓р╕Фр╣Др╕Яр╕ер╣М PDF

---

**р╕кр╕гр╕╕р╕Ы**: р╕Ыр╕▒р╕Нр╕лр╕▓р╕кр╣Ир╕зр╕Щр╕лр╕▒р╕зр╕лр╕▓р╕вр╣Др╕Ыр╣Др╕Фр╣Йр╕гр╕▒р╕Ър╕Бр╕▓р╕гр╣Бр╕Бр╣Йр╣Др╕Вр╣Бр╕ер╣Йр╕з р╕Хр╕нр╕Щр╕Щр╕╡р╣Йр╕Бр╕▓р╕гр╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Ф PDF р╕Ир╕░р╕гр╕зр╕бр╕кр╣Ир╕зр╕Щр╕лр╕▒р╕з (р╣Вр╕ер╣Вр╕Бр╣Йр╕бр╕лр╕▓р╕зр╕┤р╕Чр╕вр╕▓р╕ер╕▒р╕в) р╕Др╕гр╕Ър╕Цр╣Йр╕зр╕Щ р╕Юр╕гр╣Йр╕нр╕бр╕гр╕░р╕Ър╕Ъ fallback р╕Чр╕╡р╣Ир╣Ар╕кр╕Цр╕╡р╕вр╕г тЬЕ

**р╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ**: р╕гр╕нр╣Гр╕лр╣Йр╣Вр╕ер╣Вр╕Бр╣Йр╣Вр╕лр╕ер╕Фр╣Ар╕кр╕гр╣Зр╕И р╣Бр╕ер╣Йр╕зр╕Др╕ер╕┤р╕Б "р╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Ф PDF" р╕Ир╕░р╣Др╕Фр╣Йр╣Др╕Яр╕ер╣Мр╕Чр╕╡р╣Ир╕бр╕╡р╕кр╣Ир╕зр╕Щр╕лр╕▒р╕зр╕Др╕гр╕Ър╕Цр╣Йр╕зр╕Щ ЁЯУе